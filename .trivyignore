# Trivy CVE Ignore List
#
# This file documents known CVEs that are accepted risks with justification.
# All CVEs here are from third-party binaries we do not control.
#
# Last reviewed: 2026-02-10 by AI Review Router team
# Next review due: 2026-05-10

# ============================================================================
# OpenCode CLI Binary (Go runtime CVEs)
#
# OpenCode v1.1.40 is compiled with an older Go runtime that contains these
# vulnerabilities. We are using the latest available release. The OpenCode
# team must release a new version compiled with Go 1.24.11+ or 1.25.5+ to fix.
#
# Risk assessment: LOW - OpenCode runs in isolated subprocess with stripped
# tokens and socket listener guards (CVE-2026-22812 mitigation in place).
# ============================================================================

# Go crypto/x509 - DoS via malformed certificate
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: stdlib (crypto/x509)
# Risk: LOW - OpenCode isolated subprocess, no user-controlled certificates
# Fixed in: Go 1.24.11, 1.25.5 | OpenCode compiled with older Go
CVE-2025-61729

# Go database/sql - Postgres scanning vulnerability
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: stdlib (database/sql)
# Risk: LOW - OpenCode uses LLM APIs, not Postgres
# Fixed in: Go 1.23.12, 1.24.6 | OpenCode compiled with older Go
CVE-2025-47907

# Go archive/tar - Unbounded allocation parsing GNU tar headers
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: stdlib (archive/tar)
# Risk: LOW - OpenCode doesn't parse user-controlled tar files
# Fixed in: Go 1.23.12, 1.24.6 | OpenCode compiled with older Go
CVE-2025-58183

# ============================================================================
# npm transitive dependencies (build-time only)
# ============================================================================

# glob package - Command injection via malicious pattern
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: glob (npm)
# Risk: LOW - Build-time dependency, not used in application code
# This is a transitive dependency in Docker image tooling
CVE-2025-64756

# ============================================================================
# Additional Go dependencies in OpenCode binary
# ============================================================================

# golang.org/x/oauth2/jws - Unexpected memory consumption
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: golang.org/x/oauth2/jws
# Risk: LOW - OpenCode runs isolated with token stripping
# Fixed in: 0.27.0 | OpenCode compiled with older version
CVE-2025-22868

# Go encoding/gob - Decoder.Decode stack exhaustion
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: stdlib (encoding/gob)
# Risk: LOW - OpenCode doesn't use gob in user-facing paths
# Fixed in: Go 1.22.7, 1.23.1 | OpenCode compiled with older Go
CVE-2024-34156

# node-tar - Path traversal vulnerability in tar extraction
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: node-tar (npm)
# Risk: LOW - Only used during Docker build, not at runtime
# This is a transitive dependency in npm tooling
CVE-2026-23745

# node-tar - Arbitrary file overwrite via Unicode path collision race condition
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: node-tar (npm)
# Risk: LOW - Only used during npm ci in Docker build, not at runtime
# This is bundled with npm in the node:22-slim base image
CVE-2026-23950

# node-tar - Hardlink path traversal (CVE-2026-24842)
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: node-tar (npm)
# Risk: LOW - Only used during Docker build, not at runtime
# tar 6.2.1 bundled in npm (node:22-slim), tar 7.4.3 bundled in OpenCode 1.1.40
# Fixed in node-tar 7.5.7 | Waiting for upstream releases
CVE-2026-24842

# golang.org/x/crypto/ssh - Authorization bypass in SSH handshake
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: golang.org/x/crypto/ssh
# Risk: LOW - OpenCode doesn't use SSH for LLM API calls
# Fixed in: 0.31.0 | OpenCode compiled with v0.28.0
CVE-2024-45337

# Go net/http2 - Unlimited CONTINUATION frames causing resource exhaustion
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: stdlib (net/http2)
# Risk: LOW - OpenCode CLI mode doesn't run HTTP2 servers
# Fixed in: Go 1.21.9, 1.22.2 | OpenCode compiled with older Go
CVE-2023-45288

# ============================================================================
# Reviewdog Binary (Go runtime CVEs)
#
# Reviewdog v0.21.0 is compiled with Go 1.25.0 which contains these
# vulnerabilities. Fixed in Go 1.25.6+.
#
# Risk assessment: LOW - Reviewdog only parses diff/lint data. It does not
# negotiate TLS with untrusted peers or process user-controlled archives.
# ============================================================================

# Go net/url - Excessive query parsing causing resource exhaustion
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: stdlib (net/url)
# Risk: LOW - Reviewdog parses diff data, not URLs from untrusted sources
# Fixed in: Go 1.24.12, 1.25.6 | Reviewdog compiled with Go 1.25.0
CVE-2025-61726

# Go archive/zip - Excessive CPU consumption building archive index
# Created: 2026-01-31
# Expires: 2026-07-30
# Package: stdlib (archive/zip)
# Risk: LOW - Reviewdog doesn't process user-controlled zip files
# Fixed in: Go 1.24.12, 1.25.6 | Reviewdog compiled with Go 1.25.0
CVE-2025-61728

# Go crypto/tls - TLS 1.3 handshake panic on multiple messages in records
# Created: 2026-02-10
# Expires: 2026-08-10
# Package: stdlib (crypto/tls)
# Risk: LOW - Reviewdog parses diff/lint output, does not negotiate TLS
#   with untrusted peers. All TLS connections are outbound to GitHub API.
# Fixed in: Go 1.24.12, 1.25.6 | Reviewdog compiled with Go 1.25.0
CVE-2025-61730

# Go crypto/tls - Session resumption config mutation race condition
# Created: 2026-02-10
# Expires: 2026-08-10
# Package: stdlib (crypto/tls)
# Risk: LOW - Reviewdog is a single-threaded CLI, does not share TLS
#   configs across goroutines or perform session resumption.
# Fixed in: Go 1.24.13, 1.25.7 | Reviewdog compiled with Go 1.25.0
CVE-2025-68121
