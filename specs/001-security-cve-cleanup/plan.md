# Implementation Plan: Security CVE Exception List Cleanup and Monitoring

**Branch**: `001-security-cve-cleanup` | **Date**: 2026-01-31 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-security-cve-cleanup/spec.md`

## Summary

Clean up the CVE exception list by removing entries for vulnerabilities that have upstream fixes available (fast-xml-parser 5.3.4, reviewdog 0.21.0), add creation dates and 180-day expiration tracking to remaining exceptions, configure Dependabot for security monitoring, create CODEOWNERS governance, and add a reviewdog smoke test to CI.

## Technical Context

**Language/Version**: TypeScript 5.9.3 (ES2022 target, NodeNext modules)
**Primary Dependencies**: pnpm 10.28.2, GitHub Actions, Dependabot, Trivy 0.56.x
**Storage**: N/A (file-based configuration only: .trivyignore, CODEOWNERS, dependabot.yml)
**Testing**: Vitest 4.x (unit tests), Trivy (security scan), reviewdog smoke test (new)
**Target Platform**: Linux (GitHub Actions runners), Docker containers
**Project Type**: Single project (monorepo with router workspace)
**Performance Goals**: N/A (configuration changes, no runtime impact)
**Constraints**: Must not introduce new HIGH/CRITICAL CVEs, must maintain CI parity
**Scale/Scope**: 15 CVE exceptions → 10 or fewer after cleanup

## Constitution Check

_GATE: Must pass before Phase 0 research. Re-check after Phase 1 design._

| Principle                        | Status | Notes                                                                    |
| -------------------------------- | ------ | ------------------------------------------------------------------------ |
| I. Router Owns All Posting       | N/A    | No posting changes                                                       |
| II. Structured Findings Contract | N/A    | No finding schema changes                                                |
| III. Provider-Neutral Core       | PASS   | Changes only affect GitHub-specific files (CODEOWNERS, dependabot.yml)   |
| IV. Security-First Design        | PASS   | Reduces CVE count, adds governance                                       |
| V. Deterministic Outputs         | N/A    | No output changes                                                        |
| VI. Bounded Resources            | N/A    | No resource usage changes                                                |
| VII. Environment Discipline      | PASS   | Pinned versions, no curl\|bash installers, SHA256 verification preserved |
| VIII. Explicit Non-Goals         | PASS   | Does not add servers, runners, or secret storage                         |

**Gate Status**: PASS - All applicable principles satisfied.

## Project Structure

### Documentation (this feature)

```text
specs/001-security-cve-cleanup/
├── plan.md              # This file
├── spec.md              # Feature specification
├── research.md          # Phase 0 output
├── data-model.md        # Phase 1 output
├── quickstart.md        # Phase 1 output
├── contracts/           # Phase 1 output (minimal - config schemas)
│   └── trivyignore-schema.md
├── checklists/
│   └── requirements.md  # Quality checklist
└── tasks.md             # Phase 2 output (via /speckit.tasks)
```

### Source Code (repository root)

```text
# Files to modify
.trivyignore                    # Remove fixed CVEs, add creation dates
.github/dependabot.yml          # Add security alert configuration
CODEOWNERS                      # New file for governance
.github/workflows/ci.yml        # Add reviewdog smoke test job
router/Dockerfile               # Verify reviewdog version (already 0.21.0)

# New test fixtures
tests/fixtures/
└── reviewdog-smoke.diff        # Sample diff for smoke test
```

**Structure Decision**: Single project structure. This feature modifies configuration files and CI workflows, not application code.

## Constitution Check (Post-Design)

_Re-evaluated after Phase 1 design completion._

| Principle                        | Status | Notes                                                                        |
| -------------------------------- | ------ | ---------------------------------------------------------------------------- |
| I. Router Owns All Posting       | N/A    | No posting changes                                                           |
| II. Structured Findings Contract | N/A    | No finding schema changes                                                    |
| III. Provider-Neutral Core       | PASS   | CODEOWNERS/Dependabot are GitHub-specific but don't affect core router logic |
| IV. Security-First Design        | PASS   | Reduces CVE count from 15 to 10, adds 180-day expiration governance          |
| V. Deterministic Outputs         | N/A    | No output changes                                                            |
| VI. Bounded Resources            | N/A    | No resource usage changes                                                    |
| VII. Environment Discipline      | PASS   | Preserves pinned versions, SHA256 verification; adds smoke test validation   |
| VIII. Explicit Non-Goals         | PASS   | Does not add servers, runners, or secret storage                             |

**Post-Design Gate Status**: PASS - Design does not introduce constitution violations.

## Complexity Tracking

No constitution violations to justify.

---

## Phase 0-1 Artifacts Generated

| Artifact      | Path                                                             | Status   |
| ------------- | ---------------------------------------------------------------- | -------- |
| Research      | `specs/001-security-cve-cleanup/research.md`                     | Complete |
| Data Model    | `specs/001-security-cve-cleanup/data-model.md`                   | Complete |
| Contracts     | `specs/001-security-cve-cleanup/contracts/trivyignore-schema.md` | Complete |
| Quickstart    | `specs/001-security-cve-cleanup/quickstart.md`                   | Complete |
| Agent Context | `CLAUDE.md`                                                      | Updated  |

## Next Steps

Run `/speckit.tasks` to generate the implementation task list.
