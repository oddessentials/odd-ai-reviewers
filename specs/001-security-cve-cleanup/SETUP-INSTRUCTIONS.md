# Setup Instructions: Security CVE Monitoring

**Feature**: 001-security-cve-cleanup
**Date**: 2026-01-31

## GitHub Security Features Configuration

These steps must be performed manually via the GitHub UI by a repository administrator.

### 1. Enable Dependabot Alerts

1. Navigate to **Settings > Security > Code security and analysis**
2. Under "Dependabot", click **Enable** for:
   - **Dependabot alerts** - Receive alerts when vulnerabilities are detected
   - **Dependabot security updates** - Automatically open PRs to fix vulnerabilities

### 2. Enable Branch Protection for CODEOWNERS

1. Navigate to **Settings > Branches**
2. Click **Add branch protection rule** for `main`
3. Enable:
   - **Require a pull request before merging**
   - **Require approvals** (set to 1)
   - **Require review from Code Owners**
   - **Require status checks to pass before merging**
4. Click **Create** or **Save changes**

### 3. Verify Configuration

After enabling:

1. Go to **Security > Dependabot alerts** to see any existing alerts
2. Create a test PR that modifies `.trivyignore` and verify CODEOWNERS review is requested

---

## CVE Exception Expiration Enforcement

### Current Process (Manual)

The 180-day exception lifecycle is currently enforced via manual quarterly review:

1. **Quarterly Review Trigger**: Calendar reminder on review due date (see .trivyignore header)
2. **Check Expiration**: Review each CVE's `# Expires:` date
3. **Expired Entries**: Require CODEOWNERS re-approval or removal
4. **Update Header**: Set new "Next review due" date (90 days out)

### Review Checklist

For each CVE exception during quarterly review:

- [ ] Check if upstream fix is now available
- [ ] Verify exception is within 180-day window
- [ ] Confirm risk assessment is still accurate
- [ ] Update review date in entry metadata
- [ ] Re-calculate expiration if re-approved

### Future Automation Opportunity

A CI job could be added to:

- Parse .trivyignore for `# Expires:` dates
- Fail CI if any exception is past expiration
- Warn if any exception expires within 30 days

This is tracked as a future enhancement, not part of the current implementation scope.

---

## Go Binary Monitoring Gap

Dependabot does not monitor Go binaries (OpenCode, reviewdog) bundled in the Docker image.

### Manual Monitoring Required

1. **Check upstream releases**: When updating Dockerfile binary versions, review release notes for security fixes
2. **GitHub Security Advisories**: Search [GitHub Advisory Database](https://github.com/advisories) for Go packages
3. **Quarterly review**: Include binary version check in quarterly CVE exception review

### Current Binary Versions

| Binary    | Version | Go Version | Last Checked |
| --------- | ------- | ---------- | ------------ |
| reviewdog | 0.21.0  | Go 1.25.x  | 2026-01-31   |
| OpenCode  | 1.1.40  | Unknown    | 2026-01-31   |
