# Data Model: Security CVE Exception List

**Feature**: 001-security-cve-cleanup
**Date**: 2026-01-31

## Overview

This feature uses file-based configuration rather than application data models. The "entities" are structured comments and file formats.

---

## Entity: CVE Exception Entry

A single CVE exception in the .trivyignore file.

### Schema

```
# CVE-ID: <CVE-YYYY-NNNNN>
# Created: <YYYY-MM-DD>
# Expires: <YYYY-MM-DD>
# Package: <package-name>
# Version: <current-version>
# Fixed-In: <fixed-version | "N/A - awaiting upstream">
# Risk: <LOW | MEDIUM | HIGH>
# Justification: <brief-explanation>
# Upstream: <URL | "N/A">
<CVE-YYYY-NNNNN>
```

### Fields

| Field         | Type            | Required | Description                                    |
| ------------- | --------------- | -------- | ---------------------------------------------- |
| CVE-ID        | CVE identifier  | Yes      | Standard CVE format (CVE-YYYY-NNNNN)           |
| Created       | ISO date        | Yes      | Date exception was added (YYYY-MM-DD)          |
| Expires       | ISO date        | Yes      | Created + 180 days; triggers re-review         |
| Package       | String          | Yes      | Name of affected package/binary                |
| Version       | Semver          | Yes      | Currently installed version with vulnerability |
| Fixed-In      | Semver or "N/A" | Yes      | Version with fix, or "N/A - awaiting upstream" |
| Risk          | Enum            | Yes      | LOW, MEDIUM, or HIGH based on exploitability   |
| Justification | String          | Yes      | Why this exception is acceptable               |
| Upstream      | URL or "N/A"    | No       | Link to upstream issue tracking the fix        |

### Lifecycle States

```
┌─────────────┐
│   Created   │ Exception added with 180-day expiration
└──────┬──────┘
       │
       ▼
┌─────────────┐
│   Active    │ Within expiration window, Trivy ignores CVE
└──────┬──────┘
       │
       ├─── Fix available ──► REMOVE exception, update dependency
       │
       └─── Expires ──► ESCALATE to CODEOWNERS for re-approval
                        │
                        ├─── Re-approved ──► Reset expiration (+180 days)
                        │
                        └─── Rejected ──► REMOVE or find alternative
```

### Validation Rules

1. CVE-ID must match pattern `CVE-\d{4}-\d{4,}$`
2. Created date must be valid ISO 8601 date
3. Expires must be exactly Created + 180 days
4. Risk must be one of: LOW, MEDIUM, HIGH
5. No duplicate CVE entries allowed

---

## Entity: CODEOWNERS Entry

A single ownership rule in the CODEOWNERS file.

### Schema

```
<path-pattern> <owner> [<owner>...]
```

### Fields

| Field        | Type          | Required | Description                              |
| ------------ | ------------- | -------- | ---------------------------------------- |
| path-pattern | Glob          | Yes      | File path or glob pattern to match       |
| owner        | GitHub handle | Yes      | @username or @org/team to request review |

### Security-Related Entries

| Path Pattern             | Owner          | Rationale                                  |
| ------------------------ | -------------- | ------------------------------------------ |
| `.trivyignore`           | @oddessentials | CVE exception changes need security review |
| `SECURITY.md`            | @oddessentials | Security documentation changes             |
| `.github/dependabot.yml` | @oddessentials | Dependency update config                   |
| `router/Dockerfile`      | @oddessentials | Binary versions and security config        |

---

## Entity: Dependabot Security Alert

Managed by GitHub, not directly editable. Referenced for monitoring workflow.

### Fields (Read-Only)

| Field                    | Type    | Description                         |
| ------------------------ | ------- | ----------------------------------- |
| alert_number             | Integer | Unique identifier                   |
| severity                 | Enum    | critical, high, medium, low         |
| cve_id                   | String  | Associated CVE if available         |
| package                  | String  | Affected package ecosystem and name |
| vulnerable_version_range | String  | Affected versions                   |
| patched_version          | String  | Version with fix                    |
| state                    | Enum    | open, dismissed, fixed              |

### Integration Points

- View: GitHub Security tab > Dependabot alerts
- Auto-PRs: Created automatically when fixes available
- Dismiss: Via GitHub UI with required comment

---

## Relationships

```
┌────────────────────┐
│  .trivyignore      │
│  (CVE Exceptions)  │
└─────────┬──────────┘
          │ governs
          ▼
┌────────────────────┐
│  Trivy Scan        │
│  (CI Security)     │
└─────────┬──────────┘
          │ triggers
          ▼
┌────────────────────┐
│  Dependabot Alert  │
│  (Fix Available)   │
└─────────┬──────────┘
          │ requires approval from
          ▼
┌────────────────────┐
│  CODEOWNERS        │
│  (Governance)      │
└────────────────────┘
```
